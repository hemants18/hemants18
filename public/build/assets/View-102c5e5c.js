import{r as u,T,y as j,i as D,g as y,o as l,a as t,t as i,f as p,k as O,u as m,l as F,c as n,h as H,n as b,b as $,e as I,F as P,O as E,m as V}from"./app-586cbc19.js";import R from"./App-6c2884c7.js";import{_ as C}from"./FormSelect-4a83dbbc.js";import{_ as Z}from"./FormTextArea-8430fc21.js";import"./Sidebar-3c39994f.js";import"./Menu-d84f0ffc.js";import"./ProfileModal-e2807503.js";import"./FormInput-bee1ab8e.js";import"./FormPhoneInput-c57cb35b.js";import"./hidden-bc07d1fe.js";import"./use-text-value-a2f8b922.js";import"./transition-c0d64afd.js";import"./LangToggle-e8dc491d.js";import"./MobileSidebar-4b4dbc50.js";import"./index-a65940f1.js";/* empty css              */const q={class:"bg-white md:bg-inherit pt-0 px-4 md:pt-8 md:p-8 rounded-[5px] text-[#000] overflow-y-scroll"},G={class:"flex justify-between mt-8 md:mt-0"},J={class:"text-xl mb-1"},K={class:"grid grid-cols-2 md:flex gap-x-6 mt-4 md:mt-10"},Q={class:"col-span-2 md:order-1 md:w-[70%]"},W={class:"bg-white md:border py-5 md:px-5 rounded-[0.5rem] mb-4 text-sm"},X={class:"text-xl"},Y={class:"border border-dashed py-2 px-2 mt-8 bg-slate-100"},tt={key:0,class:"bg-white border py-5 px-5 rounded-[0.5rem] mb-4"},et={type:"submit",class:"mb-2 rounded-md bg-black px-3 py-2 text-sm text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},st={class:"flex space-x-4 text-sm"},ot={class:"bg-slate-100 rounded-full h-12 w-12 p-4 flex justify-center items-center"},it={class:"space-x-4 mb-1"},at={class:"col-span-2 w-[100%] md:order-2 md:w-[30%]"},lt={class:"bg-white md:border md:p-4 text-sm rounded-[0.5rem]"},nt={class:"bg-slate-100 p-2 rounded mb-2 space-x-3"},rt={class:"capitalize"},dt={class:"bg-slate-100 p-2 rounded mb-2 space-x-3"},ct={class:"capitalize"},ut={class:"bg-slate-100 p-2 rounded mb-2 space-x-3"},pt={key:0,class:"capitalize"},mt={key:1,class:"capitalize"},bt={class:"bg-slate-100 p-2 rounded mb-2 space-x-3"},vt={key:0,class:"capitalize"},ft={key:1,class:"capitalize"},gt={class:"bg-slate-100 p-2 rounded mb-2 space-x-3"},ht={key:0,class:"flex grid grid-cols-2 space-x-2 mt-4"},Tt={__name:"View",props:["title","ticket","users"],setup(S){const e=S,v=u(e.ticket.priority),f=u(e.ticket.assigned_to),g=u([]),r=T({message:null}),U=u([{value:"critical",label:"Critical"},{value:"high",label:"High"},{value:"medium",label:"Medium"},{value:"low",label:"Low"}]),h=o=>{const s={month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(o).toLocaleString("en-US",s)},z=(o,s)=>{const d=o.charAt(0).toUpperCase(),c=s.charAt(0).toUpperCase();return`${d}${c}`},B=()=>{r.post("/admin/support/"+e.ticket.uuid+"/comment",{preserveScroll:!0,onSuccess:()=>r.reset()})},_=o=>{E.post("/admin/support/"+e.ticket.uuid+"/status",{status:o})},L=o=>o.map(s=>({value:s.id,label:s.first_name+" "+s.last_name})),N=async o=>{try{const s=await V.post("/admin/support/"+e.ticket.uuid+"/assign",{user:o})}catch{}},A=async o=>{try{const s=await V.post("/admin/support/"+e.ticket.uuid+"/priority",{priority:o})}catch{}};return j(()=>{g.value=L(e.users)}),(o,s)=>(l(),D(R,null,{default:y(()=>{var d,c,k,w,x;return[t("div",q,[t("div",G,[t("div",null,[t("h1",J,i(o.$t("Ticket ref"))+": "+i(e.ticket.reference),1)]),t("div",null,[p(m(F),{href:"/admin/support",class:"flex items-center space-x-4 rounded-md bg-indigo-600 px-3 py-2 text-sm text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},{default:y(()=>[s[6]||(s[6]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},[t("path",{fill:"currentColor","fill-rule":"evenodd",d:"M5.841 5.28a.75.75 0 0 0-1.06-1.06L1.53 7.47L1 8l.53.53l3.25 3.25a.75.75 0 0 0 1.061-1.06l-1.97-1.97H14.25a.75.75 0 0 0 0-1.5H3.871l1.97-1.97Z","clip-rule":"evenodd"})],-1)),O(" "+i(o.$t("Back")),1)]),_:1})])]),t("div",K,[t("div",Q,[t("div",W,[t("h1",X,i(o.$t("Subject"))+": "+i(e.ticket.subject),1),t("div",Y,i(e.ticket.message),1)]),e.ticket.status==="open"||e.ticket.status==="pending"?(l(),n("div",tt,[t("form",{onSubmit:s[1]||(s[1]=H(a=>B(),["prevent"]))},[p(Z,{modelValue:m(r).message,"onUpdate:modelValue":s[0]||(s[0]=a=>m(r).message=a),name:o.$t("Comment"),type:"text",showLabel:!0,error:m(r).errors.message,textAreaRows:3,class:b("sm:col-span-6 mb-5")},null,8,["modelValue","name","error"]),t("button",et,i(o.$t("Add comment")),1)],32)])):$("",!0),(l(!0),n(P,null,I(e.ticket.comments_with_user,(a,M)=>(l(),n("div",{key:M,class:"bg-white border py-5 px-5 rounded-[0.5rem] mb-2"},[t("div",st,[t("div",null,[t("div",ot,i(z(a.user.first_name,a.user.last_name)),1)]),t("div",null,[t("div",it,[t("span",null,i(a.user.first_name+" "+a.user.last_name),1),t("span",null,i(h(a.created_at)),1)]),t("div",null,i(a.message),1)])])]))),128))]),t("div",at,[t("div",lt,[t("div",nt,[t("span",null,i(o.$t("Category"))+":",1),t("span",rt,i(e.ticket.category.name),1)]),t("div",dt,[t("span",null,i(o.$t("Status"))+":",1),t("span",ct,i(e.ticket.status),1)]),t("div",ut,[t("span",null,i(o.$t("Priority"))+":",1),e.ticket.status==="open"||e.ticket.status==="pending"?(l(),n("span",pt,[p(C,{modelValue:v.value,"onUpdate:modelValue":[s[2]||(s[2]=a=>v.value=a),A],options:U.value,class:b("w-full"),placeholder:"Not Set"},null,8,["modelValue","options"])])):(l(),n("span",mt,i(e.ticket.priority),1))]),t("div",bt,[t("span",null,i(o.$t("Assigned to"))+":",1),e.ticket.status==="open"||e.ticket.status==="pending"?(l(),n("span",vt,[p(C,{modelValue:f.value,"onUpdate:modelValue":[s[3]||(s[3]=a=>f.value=a),N],options:g.value,class:b("w-full"),placeholder:"Select User"},null,8,["modelValue","options"])])):(l(),n("span",ft,i((d=e.ticket)!=null&&d.agent?((k=(c=e.ticket)==null?void 0:c.agent)==null?void 0:k.first_name)+" "+((x=(w=e.ticket)==null?void 0:w.agent)==null?void 0:x.last_name):o.$t("Not set")),1))]),t("div",gt,[t("span",null,i(o.$t("Date created"))+":",1),t("span",null,i(h(e.ticket.created_at)),1)]),e.ticket.status==="open"||e.ticket.status==="pending"?(l(),n("div",ht,[t("button",{onClick:s[4]||(s[4]=a=>_("closed")),class:"mb-2 rounded-md bg-black px-3 py-2 text-sm text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},i(o.$t("Close ticket")),1),t("button",{onClick:s[5]||(s[5]=a=>_("resolved")),class:"mb-2 rounded-md bg-black px-3 py-2 text-sm text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},i(o.$t("Mark as resolved")),1)])):$("",!0)])])])])]}),_:1}))}};export{Tt as default};
