import{r as x,T as j,q as F,x as G,i as y,g as E,o,a as t,t as d,f as h,k as f,u as a,l as A,h as Z,n as c,b as p,w as H,y as R,c as u,F as k,e as $,p as Y}from"./app-71688fef.js";import P from"./App-dbd17314.js";import{_ as V}from"./FormInput-20df0373.js";import{t as v,_ as b}from"./FormSelect-4c8a2141.js";import{_ as J}from"./WhatsappTemplate-1712220b.js";/* empty css              */import"./Sidebar-4facdee5.js";import"./Menu-51e1dddd.js";import"./Modal-0745b486.js";import"./transition-69c2c596.js";import"./hidden-1e440d84.js";import"./ProfileModal-a0ead7b3.js";import"./use-text-value-42fe46f0.js";import"./index-e82fb76e.js";import"./MobileSidebar-11af113e.js";const K={class:"md:flex md:flex-col bg-white border-l py-4 text-[#000] capitalize overflow-y-hidden"},Q={class:"flex justify-between px-8 border-b pb-2"},X={class:"text-xl mb-1"},W={class:"flex items-center text-sm leading-6 text-gray-600"},ee={class:"ml-1 mt-1"},te={class:"space-x-2 flex items-center"},se={class:"md:flex md:flex-grow-1"},ae={class:"grid gap-x-6 gap-y-4 sm:grid-cols-6 mb-8"},le={class:"relative flex gap-x-3 sm:col-span-6"},re={class:"flex h-6 items-center"},oe={class:"text-sm leading-6"},ne={for:"skip-schedule",class:"font-medium text-gray-900"},ie={key:0,class:"bg-slate-100 p-3 mt-4 text-sm"},de={class:"flex items-center justify-between space-x-2 pb-2 border-b"},ue={class:"flex items-center space-x-2"},pe={key:0,class:"w-full"},me={key:1,class:"w-full"},ce={key:2,class:"w-full mt-3"},fe={class:"flex items-center space-x-4"},he=["accept"],ve={key:0,class:"w-[20em] truncate"},ye={key:1},be={key:0,class:"text-left text-xs mt-2"},ge={key:1,class:"text-left text-xs mt-2"},we={key:2,class:"text-left text-xs mt-2"},xe={key:0,class:"form-error text-[#b91c1c] text-xs"},Ve={key:1,class:"bg-slate-100 p-3 mt-1 text-sm"},_e={class:"flex items-center justify-between space-x-2 pb-2 border-b"},ke={class:"flex items-center space-x-2"},$e={class:"w-[40%]"},Ue=["textContent"],Ce={class:"w-full"},Me={class:"w-full"},Ee={key:2,class:"bg-slate-100 p-3 mt-1 text-sm"},Be={class:"flex items-center justify-between space-x-2 pb-2 border-b"},Oe={class:"flex items-center space-x-2"},ze={key:0,class:"mt-4 bg-slate-50 p-3"},Ae={class:"w-[100%] mb-1"},De={class:"w-full"},Se={class:"w-full"},Te={class:"flex items-center justify-end space-x-3 mt-3"},Ne=["disabled"],Ie={key:0},Le={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},qe={class:"md:w-[50%] py-20 px-20 flex justify-center chat-bg"},st={__name:"Create",props:["templates","contactGroups"],setup(D){const B=D,_=x(!1),U=x([{value:"all",label:v("all contacts")}]),O=x([]),C=x([{value:"static",label:v("static")},{value:"dynamic",label:v("dynamic")}]),M=x([{value:"first name",label:v("contact first name")},{value:"last name",label:v("contact last name")},{value:"name",label:v("contact full name")},{value:"phone",label:v("contact phone")},{value:"email",label:v("contact email")}]),e=j({name:null,template:null,contacts:null,time:null,skip_schedule:!1,header:{format:null,text:null,parameters:[]},body:{text:null,parameters:[]},footer:{text:null},buttons:[]}),S=F(()=>e.buttons.some(l=>l.parameters&&l.parameters.length>0)),T=async()=>{try{const l=await Y.get("/templates/"+e.template);if(l){const s=JSON.parse(l.data.metadata);e.header.format=g(s,"HEADER","format"),e.header.text=g(s,"HEADER","text");const n=g(s,"HEADER","example");n?e.header.format==="TEXT"?e.header.parameters=n.header_text.map(m=>({type:"text",selection:"static",value:m})):(e.header.format==="IMAGE"||e.header.format==="DOCUMENT"||e.header.format==="VIDEO")&&(e.header.parameters=n.header_handle.map(m=>({type:e.header.format,selection:"default",value:null,url:m}))):e.header.parameters=[],e.body.text=g(s,"BODY","text");const r=g(s,"BODY","example");r?e.body.parameters=r.body_text[0].map(m=>({type:"text",selection:"static",value:m})):e.body.parameters=[],e.footer.text=g(s,"FOOTER","text");const i=g(s,"BUTTONS","buttons");i?e.buttons=i.map(m=>({type:m.type,text:m.text,value:m[m.type.toLowerCase()]??null,parameters:m.type==="QUICK_REPLY"?[{type:"static",value:null}]:m.example?m.example.map(w=>({type:"static",value:w})):[]})):e.buttons=[]}}catch{}},N=l=>{const s=L(e.header.parameters[0].type),n=l.target.files[0];if(n&&n.size>s)alert(v("file size exceeds the limit. Max allowed size:")+" "+s+"b"),l.target.value=null;else{const r=new FileReader;r.onload=i=>{e.header.parameters[0].url=i.target.result},e.header.parameters[0].selection="upload",e.header.parameters[0].value=n,r.readAsDataURL(n)}},I=l=>{switch(l){case"IMAGE":return".png, .jpg";case"DOCUMENT":return".pdf, .txt, .ppt, .doc, .xls, .docx, .pptx, .xlsx";case"VIDEO":return".mp4";default:return""}},L=l=>{switch(l){case"IMAGE":return 5*1024*1024;case"DOCUMENT":return 100*1024*1024;case"VIDEO":return 16*1024*1024;default:return 1/0}},g=(l,s,n)=>{const r=l.components.find(i=>i.type===s);return r?r[n]:null},z=l=>l.map(s=>({value:s.uuid,label:s.language?s.name+" ["+s.language+"]":s.name})),q=()=>{_.value=!0,e.post("/campaigns",{onFinish:()=>{_.value=!1}})};return G(()=>{O.value=z(B.templates),U.value=[...U.value,...z(B.contactGroups)]}),(l,s)=>(o(),y(P,null,{default:E(()=>[t("div",K,[t("div",Q,[t("div",null,[t("h2",X,d(l.$t("New campaign")),1),t("p",W,[s[6]||(s[6]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},[t("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 11v5m0 5a9 9 0 1 1 0-18a9 9 0 0 1 0 18Zm.05-13v.1h-.1V8h.1Z"})],-1)),t("span",ee,d(l.$t("Create campaign")),1)])]),t("div",te,[h(a(A),{href:"/campaigns",class:"rounded-md bg-black px-3 py-2 text-sm text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},{default:E(()=>[f(d(l.$t("Back")),1)]),_:1})])]),t("div",se,[t("form",{onSubmit:s[5]||(s[5]=Z(n=>q(),["prevent"])),class:"md:w-[50%] p-4 md:p-8 overflow-y-auto h-[90vh]"},[t("div",ae,[h(V,{modelValue:a(e).name,"onUpdate:modelValue":s[0]||(s[0]=n=>a(e).name=n),name:l.$t("Campaign name"),type:"text",error:a(e).errors.name,required:!0,class:c("sm:col-span-6")},null,8,["modelValue","name","error"]),h(b,{modelValue:a(e).template,"onUpdate:modelValue":[s[1]||(s[1]=n=>a(e).template=n),T],options:O.value,required:!0,error:a(e).errors.template,name:l.$t("Template"),class:c("sm:col-span-3"),placeholder:l.$t("Select template")},null,8,["modelValue","options","error","name","placeholder"]),h(b,{modelValue:a(e).contacts,"onUpdate:modelValue":s[2]||(s[2]=n=>a(e).contacts=n),options:U.value,name:l.$t("Send to"),required:!0,class:c("sm:col-span-3"),placeholder:l.$t("Select contacts"),error:a(e).errors.contacts},null,8,["modelValue","options","name","placeholder","error"]),a(e).skip_schedule?p("",!0):(o(),y(V,{key:0,modelValue:a(e).time,"onUpdate:modelValue":s[3]||(s[3]=n=>a(e).time=n),name:l.$t("Scheduled time"),type:"datetime-local",error:a(e).errors.time,required:!0,class:c("sm:col-span-6")},null,8,["modelValue","name","error"])),t("div",le,[t("div",re,[H(t("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>a(e).skip_schedule=n),id:"skip-schedule",name:"skip-schedule",type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600"},null,512),[[R,a(e).skip_schedule]])]),t("div",oe,[t("label",ne,d(l.$t("Skip scheduling & send immediately")),1)])])]),t("div",null,[a(e).header.parameters.length>0?(o(),u("div",ie,[t("h2",de,[t("div",ue,[t("span",null,d(l.$t("Header variables")),1),s[7]||(s[7]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 1024 1024"},[t("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296c-44.096 0-108.992 44.736-148.48 101.504c0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04c67.84 0 107.904-43.648 147.456-100.416z"})],-1))]),s[8]||(s[8]=t("span",null,[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M6.102 16.98c-1.074 0-1.648-1.264-.94-2.073l5.521-6.31a1.75 1.75 0 0 1 2.634 0l5.522 6.31c.707.809.133 2.073-.94 2.073H6.101Z"})])],-1))]),(o(!0),u(k,null,$(a(e).header.parameters,(n,r)=>(o(),u("div",{key:r,class:"mt-2 flex items-center space-x-4"},[a(e).header.parameters[r].type==="text"?(o(),u("div",pe,[h(b,{modelValue:a(e).header.parameters[r].selection,"onUpdate:modelValue":i=>a(e).header.parameters[r].selection=i,name:l.$t("Content type"),options:C.value,class:c("sm:col-span-6")},null,8,["modelValue","onUpdate:modelValue","name","options"])])):p("",!0),a(e).header.parameters[r].type==="text"?(o(),u("div",me,[a(e).header.parameters[r].selection==="static"?(o(),y(V,{key:0,name:l.$t("Value"),required:!0,error:a(e).errors["header.parameters.0.value"],modelValue:a(e).header.parameters[r].value,"onUpdate:modelValue":i=>a(e).header.parameters[r].value=i,type:"text",class:c("sm:col-span-6")},null,8,["name","error","modelValue","onUpdate:modelValue"])):p("",!0),a(e).header.parameters[r].selection==="dynamic"?(o(),y(b,{key:1,name:l.$t("Value"),required:!0,error:a(e).errors["header.parameters.0.value"],modelValue:a(e).header.parameters[r].value,"onUpdate:modelValue":i=>a(e).header.parameters[r].value=i,options:M.value,class:c("sm:col-span-6")},null,8,["name","error","modelValue","onUpdate:modelValue","options"])):p("",!0)])):p("",!0),["IMAGE","DOCUMENT","VIDEO"].includes(a(e).header.parameters[r].type)?(o(),u("div",ce,[t("div",null,[t("div",fe,[t("label",{class:c(["cursor-pointer flex justify-center px-2 py-2 w-[30%] bg-slate-200 shadow-sm rounded-lg border",a(e).errors["header.parameters.0.value"]?"border border-red-700":""]),for:"file-upload"},d(l.$t("Upload"))+" "+d(a(e).header.parameters[r].type.toLowerCase()),3),t("input",{type:"file",class:"sr-only",accept:I(a(e).header.parameters[r].type),ref_for:!0,ref:"fileInput",id:"file-upload",onChange:N},null,40,he),a(e).header.parameters[r].value?(o(),u("div",ve,d(a(e).header.parameters[r].selection==="default"?a(e).header.parameters[r].value:a(e).header.parameters[r].value.name),1)):(o(),u("span",ye,d(l.$t("No file chosen")),1))]),a(e).header.parameters[r].type==="IMAGE"?(o(),u("p",be,[f(d(l.$t("Max file upload size is"))+" ",1),s[9]||(s[9]=t("b",null,"5MB",-1)),s[10]||(s[10]=f()),s[11]||(s[11]=t("br",null,null,-1)),f(" "+d(l.$t("Supported file extensions"))+": .png, jpg",1)])):p("",!0),a(e).header.parameters[r].type==="DOCUMENT"?(o(),u("p",ge,[f(d(l.$t("Max file upload size is"))+" ",1),s[12]||(s[12]=t("b",null,"100MB",-1)),s[13]||(s[13]=f()),s[14]||(s[14]=t("br",null,null,-1)),f(" "+d(l.$t("Supported file extensions"))+": .pdf, .txt, .ppt, .doc, .xls, .docx, .pptx, .xlsx",1)])):p("",!0),a(e).header.parameters[r].type==="VIDEO"?(o(),u("p",we,[f(d(l.$t("Max file upload size is"))+" ",1),s[15]||(s[15]=t("b",null,"16MB",-1)),s[16]||(s[16]=f()),s[17]||(s[17]=t("br",null,null,-1)),f(" "+d(l.$t("Supported file extensions"))+": .mp4",1)])):p("",!0)]),a(e).errors["header.parameters.0.value"]?(o(),u("div",xe,d(a(e).errors["header.parameters.0.value"]),1)):p("",!0)])):p("",!0)]))),128))])):p("",!0),a(e).body.parameters.length>0?(o(),u("div",Ve,[t("h2",_e,[t("div",ke,[t("span",null,d(l.$t("Body variables")),1),s[18]||(s[18]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 1024 1024"},[t("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296c-44.096 0-108.992 44.736-148.48 101.504c0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04c67.84 0 107.904-43.648 147.456-100.416z"})],-1))]),s[19]||(s[19]=t("span",null,[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M6.102 16.98c-1.074 0-1.648-1.264-.94-2.073l5.521-6.31a1.75 1.75 0 0 1 2.634 0l5.522 6.31c.707.809.133 2.073-.94 2.073H6.101Z"})])],-1))]),(o(!0),u(k,null,$(a(e).body.parameters,(n,r)=>(o(),u("div",{key:r,class:"mt-2 flex items-center space-x-4"},[t("div",$e,[t("span",{textContent:d("{{"+(r+1)+"}}")},null,8,Ue)]),t("div",Ce,[h(b,{modelValue:a(e).body.parameters[r].selection,"onUpdate:modelValue":i=>a(e).body.parameters[r].selection=i,options:C.value,class:c("sm:col-span-6")},null,8,["modelValue","onUpdate:modelValue","options"])]),t("div",Me,[a(e).body.parameters[r].selection==="static"?(o(),y(V,{key:0,modelValue:a(e).body.parameters[r].value,"onUpdate:modelValue":i=>a(e).body.parameters[r].value=i,required:!0,error:a(e).errors["body.parameters.0.value"],type:"text",class:c("sm:col-span-6")},null,8,["modelValue","onUpdate:modelValue","error"])):p("",!0),a(e).body.parameters[r].selection==="dynamic"?(o(),y(b,{key:1,modelValue:a(e).body.parameters[r].value,"onUpdate:modelValue":i=>a(e).body.parameters[r].value=i,required:!0,error:a(e).errors["body.parameters.0.value"],options:M.value,class:c("sm:col-span-6")},null,8,["modelValue","onUpdate:modelValue","error","options"])):p("",!0)])]))),128))])):p("",!0),a(e).buttons.length>0&&S.value?(o(),u("div",Ee,[t("h2",Be,[t("div",Oe,[t("span",null,d(l.$t("Button variables")),1),s[20]||(s[20]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 1024 1024"},[t("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296c-44.096 0-108.992 44.736-148.48 101.504c0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04c67.84 0 107.904-43.648 147.456-100.416z"})],-1))]),s[21]||(s[21]=t("span",null,[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M6.102 16.98c-1.074 0-1.648-1.264-.94-2.073l5.521-6.31a1.75 1.75 0 0 1 2.634 0l5.522 6.31c.707.809.133 2.073-.94 2.073H6.101Z"})])],-1))]),(o(!0),u(k,null,$(a(e).buttons,(n,r)=>(o(),u("div",{key:r},[n.parameters.length>0?(o(),u("div",ze,[t("div",Ae,[t("span",null,d(l.$t("Label"))+": "+d(n.text),1)]),(o(!0),u(k,null,$(n.parameters,(i,m)=>(o(),u("div",{key:m,class:"flex items-center space-x-4"},[t("div",De,[h(b,{modelValue:i.type,"onUpdate:modelValue":w=>i.type=w,name:l.$t("Button type"),options:C.value,class:c("sm:col-span-6")},null,8,["modelValue","onUpdate:modelValue","name","options"])]),t("div",Se,[i.type==="static"?(o(),y(V,{key:0,modelValue:i.value,"onUpdate:modelValue":w=>i.value=w,name:l.$t("Value"),required:!0,error:a(e).errors["buttons."+r+".parameters.0.value"],type:"text",class:c("sm:col-span-6")},null,8,["modelValue","onUpdate:modelValue","name","error"])):p("",!0),i.type==="dynamic"?(o(),y(b,{key:1,modelValue:i.value,"onUpdate:modelValue":w=>i.value=w,name:l.$t("Value"),required:!0,error:a(e).errors["buttons."+r+".parameters.0.value"],options:M.value,class:c("sm:col-span-6")},null,8,["modelValue","onUpdate:modelValue","name","error","options"])):p("",!0)])]))),128))])):p("",!0)]))),128))])):p("",!0),t("div",Te,[t("div",null,[h(a(A),{href:"/campaigns",class:"block rounded-md px-3 py-2 text-sm text-gray-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 bg-slate-200"},{default:E(()=>[f(d(l.$t("Cancel")),1)]),_:1})]),t("div",null,[t("button",{type:"submit",class:"rounded-md px-3 py-2 text-sm text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 bg-primary",disabled:_.value},[_.value?(o(),u("svg",Le,[...s[22]||(s[22]=[t("path",{fill:"currentColor",d:"M12 2A10 10 0 1 0 22 12A10 10 0 0 0 12 2Zm0 18a8 8 0 1 1 8-8A8 8 0 0 1 12 20Z",opacity:".5"},null,-1),t("path",{fill:"currentColor",d:"M20 12h2A10 10 0 0 0 12 2V4A8 8 0 0 1 20 12Z"},[t("animateTransform",{attributeName:"transform",dur:"1s",from:"0 12 12",repeatCount:"indefinite",to:"360 12 12",type:"rotate"})],-1)])])):(o(),u("span",Ie,d(l.$t("Save")),1))],8,Ne)])])])],32),t("div",qe,[t("div",null,[h(J,{parameters:a(e),visible:!!a(e).template},null,8,["parameters","visible"])])])])])]),_:1}))}};export{st as default};
