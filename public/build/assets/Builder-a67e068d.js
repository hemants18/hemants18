import se from"./App-dbd17314.js";import{o as c,c as x,a as e,F as M,e as R,n as B,t as N,r as T,d as F,w as g,a0 as E,ad as P,v as V,k as q,f as k,u as m,q as $,b as O,z as de,p as ae,H as te,x as le,g as z,K as ne,i as oe,_ as ie,N as re,h as ue}from"./app-71688fef.js";import{P as S,_ as L,a as pe}from"./vue-flow-core-436bf019.js";import{_ as ce,a as me}from"./vue-flow-controls-e2103ca9.js";import{_ as ve}from"./vue-flow-minimap-06aa8dc9.js";import{t as G}from"./FormSelect-4c8a2141.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import{x as be,O as ge}from"./index.es-dab8f442.js";import"./Sidebar-4facdee5.js";import"./Menu-51e1dddd.js";import"./Modal-0745b486.js";import"./transition-69c2c596.js";import"./hidden-1e440d84.js";import"./ProfileModal-a0ead7b3.js";import"./FormInput-20df0373.js";import"./use-text-value-42fe46f0.js";import"./index-e82fb76e.js";import"./MobileSidebar-11af113e.js";/* empty css              */const xe={class:"p-4 bg-white h-full"},fe=["onDragstart"],ye={__name:"NodeSidebar",setup(U){const t=[{type:"text",label:"Text Message",icon:"la-sms"},{type:"button",label:"Buttons",icon:"la-mouse-pointer"},{type:"cta",label:"Call to Action",icon:"la-link"},{type:"media",label:"Media",icon:"la-photo-video"},{type:"list",label:"List",icon:"la-list"},{type:"location",label:"Location",icon:"la-globe"},{type:"contact",label:"Contact Card",icon:"la-id-card"},{type:"delay",label:"Delay",icon:"la-clock"},{type:"condition",label:"Condition",icon:"la-random"},{type:"end",label:"End",icon:"la-stop-circle"}],a=(v,u)=>{v.dataTransfer.setData("nodeType",u)};return(v,u)=>(c(),x("div",xe,[u[0]||(u[0]=e("h3",{class:"font-bold mb-4"},"Nodes",-1)),(c(),x(M,null,R(t,b=>e("div",{key:b.type,draggable:"true",onDragstart:h=>a(h,b.type),class:"flex items-center space-x-3 p-2 mb-2 border rounded cursor-grab bg-gray-50 hover:bg-gray-100 transition"},[e("i",{class:B(["la",b.icon,"text-xl text-indigo-600"])},null,2),e("span",null,N(b.label),1)],40,fe)),64))]))}},we={class:"flow-node trigger-node relative overflow-hidden rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"300px","max-width":"380px"}},he={class:"p-4"},_e={class:"flex items-center justify-between mb-3"},$e={class:"flex space-x-1"},Ne={key:1,disabled:"",class:"border p-1.5 rounded-md bg-gray-100 text-gray-300"},Ce={class:"mb-4"},ke=["value"],De={class:"mb-4"},Ue={class:"flex mb-3 mt-2"},Ve={class:"flex flex-wrap gap-2"},Te=["onClick"],Se={__name:"StartNode",props:{id:String,data:{type:Object,default:()=>({keywords:[],updateNodeData:null,deleteNode:null,copyNode:null})}},setup(U){const t=U,a=T(t.data.criteria||""),v=T([{value:"exact match",label:G("When text is an exact match to trigger text")},{value:"contains",label:G("When text contains trigger text")}]),u=T(""),b=T(!1),h=()=>{b.value=!b.value},f=()=>{t.data.copyNode({id:t.id})},C=()=>{t.data.deleteNode(t.id)},r=()=>{const _=u.value.trim();if(!_)return;const d=[...Array.isArray(t.data.keywords)?t.data.keywords:[],_];t.data.updateNodeData(t.id,{keywords:d}),u.value=""},w=_=>{const d=(Array.isArray(t.data.keywords)?t.data.keywords:[]).filter(l=>l!==_);t.data.updateNodeData(t.id,{keywords:d})};return(_,i)=>(c(),x("div",we,[i[10]||(i[10]=e("div",{class:"h-1.5 rounded-t-md bg-gradient-to-r from-red-500 to-orange-500"},null,-1)),e("div",he,[e("div",_e,[i[6]||(i[6]=F('<div class="flex items-center"><div class="mr-3 rounded-lg p-2 bg-red-100 text-red-600"><i class="las la-walking"></i></div><div><div class="text-sm font-medium">Start Trigger</div><span class="bg-purple-100 px-2 py-0.5 text-xs rounded-full"> Entry Point </span></div></div>',1)),e("div",$e,[e("button",{onClick:h,class:"border p-1.5 rounded-md"},[e("i",{class:B(b.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:f,class:"border p-1.5 rounded-md"},[...i[3]||(i[3]=[e("i",{class:"las la-copy"},null,-1)])]),t.data.isPrimary?(c(),x("button",Ne,[...i[5]||(i[5]=[e("i",{class:"las la-trash-alt"},null,-1)])])):(c(),x("button",{key:0,onClick:C,class:"rounded-md border p-1.5 text-red-600 hover:bg-red-50"},[...i[4]||(i[4]=[e("i",{class:"las la-trash-alt"},null,-1)])]))])]),g(e("div",null,[e("div",Ce,[i[8]||(i[8]=e("label",{class:"text-xs font-medium"},"Trigger Type *",-1)),g(e("select",{"onUpdate:modelValue":i[0]||(i[0]=d=>a.value=d),onChange:i[1]||(i[1]=d=>t.data.updateNodeData(t.id,{criteria:a.value})),class:"w-full border rounded-md p-2 text-sm mt-1"},[i[7]||(i[7]=e("option",{value:"",disabled:""},"Select criteria",-1)),(c(!0),x(M,null,R(v.value,d=>(c(),x("option",{key:d.value,value:d.value},N(d.label),9,ke))),128))],544),[[P,a.value]])]),e("div",De,[i[9]||(i[9]=e("label",{class:"text-xs font-medium text-gray-700"}," Trigger Keywords * ",-1)),e("div",Ue,[g(e("input",{"onUpdate:modelValue":i[2]||(i[2]=d=>u.value=d),type:"text",placeholder:"Add a keyword...",class:"w-full border rounded-l-md px-3 py-2 text-sm"},null,512),[[V,u.value]]),e("button",{onClick:r,class:"bg-purple-600 text-white px-3 rounded-r-md"}," + ")]),e("div",Ve,[(c(!0),x(M,null,R(t.data.keywords,d=>(c(),x("div",{key:d,class:"flex items-center rounded-full bg-purple-100 px-3 py-1.5 text-xs"},[q(N(d)+" ",1),e("button",{onClick:l=>w(d),class:"ml-1"},"Ã—",8,Te)]))),128))])])],512),[[E,!b.value]])]),k(m(L),{type:"source",id:"output",position:m(S).Right,class:"!bg-orange-500"},null,8,["position"])]))}},Le={class:"flow-node trigger-node relative overflow-hidden rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"300px","max-width":"380px"}},Ae={class:"p-4"},Ee={class:"flex items-center justify-between mb-3"},Be={class:"flex space-x-1"},je={class:"mb-4"},K=1e3,Me={__name:"TextNode",props:{id:String,data:Object},setup(U){const t=U,a=$({get(){return t.data.message||""},set(C){t.data.updateNodeData(t.id,{message:C.slice(0,K)})}}),v=$(()=>a.value.length),u=T(!1),b=()=>{u.value=!u.value},h=()=>{t.data.copyNode({id:t.id})},f=()=>{t.data.deleteNode(t.id)};return(C,r)=>(c(),x("div",Le,[r[5]||(r[5]=e("div",{class:"h-1.5 rounded-t-md bg-gradient-to-r from-red-500 to-orange-500"},null,-1)),e("div",Ae,[e("div",Ee,[r[3]||(r[3]=e("div",{class:"flex items-center"},[e("div",{class:"mr-3 rounded-lg p-2 bg-red-100 text-red-600"},[e("i",{class:"las la-comment-alt"})]),e("div",null,[e("div",{class:"text-sm font-medium"},"Text Message")])],-1)),e("div",Be,[e("button",{onClick:b,class:"border p-1.5 rounded-md"},[e("i",{class:B(u.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:h,class:"border p-1.5 rounded-md"},[...r[1]||(r[1]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:f,class:"rounded-md border p-1.5 text-red-600 hover:bg-red-50"},[...r[2]||(r[2]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),g(e("div",null,[e("div",je,[r[4]||(r[4]=e("label",{class:"text-xs font-medium"},"Message *",-1)),g(e("textarea",{"onUpdate:modelValue":r[0]||(r[0]=w=>a.value=w),class:"w-full border rounded-md p-2 text-sm mt-1",rows:"4",maxlength:"1000"},null,512),[[V,a.value]]),e("div",{class:B(["mt-1 text-xs flex justify-end",v.value>=K?"text-red-600":"text-gray-500"])},N(v.value)+" / "+N(K)+" characters ",3)])],512),[[E,!u.value]])]),k(m(L),{type:"target",id:"input",position:m(S).Left,class:"!bg-orange-500"},null,8,["position"]),k(m(L),{type:"source",id:"output",position:m(S).Right,class:"!bg-blue-500"},null,8,["position"])]))}},Re={class:"flow-node trigger-node relative overflow-hidden rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"300px","max-width":"380px"}},Oe={class:"p-4"},Xe={class:"flex items-center justify-between mb-3"},Pe={class:"flex space-x-1"},qe={class:"mb-4"},Fe={class:"text-xs text-gray-500 text-right"},He={class:"flex justify-between items-center mb-2"},ze={class:"text-xs text-gray-400"},Ke={class:"flex justify-between items-center mb-2"},We={class:"text-sm font-medium"},Ye=["onClick"],Ge=["value","onInput"],Ie=["value","onInput"],Ze={class:"text-xs mt-2 flex justify-between"},Je=["disabled"],I=1024,W=3,Qe=20,et={__name:"ButtonNode",props:{id:String,data:{type:Object,required:!0}},setup(U){const t=U,a=$({get:()=>t.data.message||"",set:d=>{t.data.updateNodeData(t.id,{message:d.slice(0,I)})}}),v=$(()=>a.value.length),u=$(()=>t.data.buttons||[]),b=d=>`button-${d}`,h=()=>{u.value.length>=W||t.data.updateNodeData(t.id,{buttons:[...u.value,{text:"",value:"",connected:!1}]})},f=d=>{const l=b(d);t.data.removeButtonEdges(t.id,l);const s=[...u.value];s.splice(d,1),t.data.updateNodeData(t.id,{buttons:s})},C=(d,l,s)=>{const y=[...u.value];y[d][l]=l==="text"?s.slice(0,Qe):s,t.data.updateNodeData(t.id,{buttons:y})};$(()=>{const d=[];return a.value.trim()||d.push("Message text is required"),u.value.some(l=>!l.text.trim()||!l.value.trim())&&d.push("All buttons must have text and value"),u.value.some(l=>!l.connected)&&d.push("All buttons must be connected to another node"),d});const r=T(!1),w=()=>{r.value=!r.value},_=()=>{t.data.copyNode({id:t.id})},i=()=>{t.data.deleteNode(t.id)};return(d,l)=>(c(),x("div",Re,[l[8]||(l[8]=e("div",{class:"h-1.5 rounded-t-md bg-gradient-to-r from-red-500 to-orange-500"},null,-1)),e("div",Oe,[e("div",Xe,[l[3]||(l[3]=e("div",{class:"flex items-center"},[e("div",{class:"mr-3 rounded-lg p-2 bg-red-100 text-red-600"},[e("i",{class:"las la-caret-square-up"})]),e("div",null,[e("div",{class:"text-sm font-medium"},"Button Message")])],-1)),e("div",Pe,[e("button",{onClick:w,class:"border p-1.5 rounded-md"},[e("i",{class:B(r.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:_,class:"border p-1.5 rounded-md"},[...l[1]||(l[1]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:i,class:"rounded-md border p-1.5 text-red-600 hover:bg-red-50"},[...l[2]||(l[2]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),g(e("div",null,[e("div",qe,[l[4]||(l[4]=e("label",{class:"text-xs font-medium"},"Message Text *",-1)),g(e("textarea",{"onUpdate:modelValue":l[0]||(l[0]=s=>a.value=s),rows:"3",class:"w-full border rounded-md p-2 text-sm mt-1"},null,512),[[V,a.value]]),e("div",Fe,N(v.value)+"/"+N(I),1)]),e("div",null,[e("div",He,[l[5]||(l[5]=e("span",{class:"text-sm font-medium"},"Buttons",-1)),e("span",ze,N(u.value.length)+"/"+N(W),1)]),(c(!0),x(M,null,R(u.value,(s,y)=>(c(),x("div",{key:y,class:"border rounded-md p-3 mb-3 bg-red-50 relative"},[k(m(L),{type:"source",id:b(y),position:m(S).Right,class:"!h-3 !w-3 !border-2 !border-white bg-red-500 absolute -right-2 top-6"},null,8,["id","position"]),e("div",Ke,[e("span",We,"Button "+N(y+1),1),e("button",{onClick:n=>f(y),class:"text-red-500 text-xs"}," âœ• ",8,Ye)]),l[6]||(l[6]=e("label",{class:"text-xs font-medium"}," Button Text * ",-1)),e("input",{type:"text",value:s.text,onInput:n=>C(y,"text",n.target.value),class:"w-full border rounded-md p-2 text-sm mb-2",placeholder:"Button text (max 20 chars)"},null,40,Ge),l[7]||(l[7]=e("label",{class:"text-xs font-medium"}," Value * ",-1)),e("input",{type:"text",value:s.value,onInput:n=>C(y,"value",n.target.value),class:"w-full border rounded-md p-2 text-sm",placeholder:"Payload value"},null,40,Ie),e("div",Ze,[e("span",null," Button "+N(y+1)+" response ",1),e("span",{class:B(s.connected?"text-green-600":"text-red-500")},N(s.connected?"Connected":"Not connected"),3)])]))),128)),e("button",{onClick:h,disabled:u.value.length>=W,class:"w-full py-2 text-sm rounded-md bg-blue-50 text-blue-600"}," + Add Button ",8,Je)])],512),[[E,!r.value]])]),k(m(L),{type:"target",id:"input",position:m(S).Left,class:"!h-4 !w-4 !border-2 !border-white bg-gradient-to-r from-red-500 to-orange-500"},null,8,["position"])]))}},tt={class:"flow-node trigger-node relative overflow-hidden rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"300px","max-width":"380px"}},lt={class:"p-4"},ot={class:"flex items-center justify-between mb-3"},st={class:"flex space-x-1"},dt={key:0,class:"m-3 border border-red-300 bg-red-50 rounded-md p-3 text-sm"},at={class:"list-disc list-inside text-red-600"},nt={class:"text-xs text-right text-gray-400"},it={class:"text-xs text-right text-gray-400"},rt={key:0,class:"text-xs text-red-500"},ut={class:"text-xs text-right text-gray-400"},pt={key:0,class:"text-xs text-red-500"},ct={class:"text-xs text-right text-gray-400"},mt={class:"border rounded-md p-3 bg-gray-50"},vt={class:"text-xs mb-2"},bt={class:"text-sm mb-2"},gt={class:"w-full py-2 rounded-md bg-yellow-500 text-white text-sm"},xt={class:"text-xs mb-2"},Z=60,J=1e3,Q=20,ee=60,ft={__name:"CallToActionNode",props:{id:String,data:{type:Object,required:!0}},setup(U){const t=U,a=$({get:()=>t.data.header||"",set:y=>t.data.updateNodeData(t.id,{header:y.slice(0,Z)})}),v=$({get:()=>t.data.valueText||"",set:y=>t.data.updateNodeData(t.id,{valueText:y.slice(0,J)})}),u=$({get:()=>t.data.buttonText||"Click Here",set:y=>t.data.updateNodeData(t.id,{buttonText:y.slice(0,Q)})}),b=$({get:()=>t.data.buttonLink||"",set:y=>t.data.updateNodeData(t.id,{buttonLink:y})}),h=$({get:()=>t.data.footer||"",set:y=>t.data.updateNodeData(t.id,{footer:y.slice(0,ee)})}),f=$(()=>a.value.length),C=$(()=>v.value.length),r=$(()=>u.value.length),w=$(()=>h.value.length),_=$(()=>{const y=[];return v.value.trim()||y.push("Value text is required"),u.value.trim()||y.push("Button text is required"),b.value.trim()||y.push("Valid button link is required"),y}),i=T(!1),d=()=>{i.value=!i.value},l=()=>{t.data.copyNode({id:t.id})},s=()=>{t.data.deleteNode(t.id)};return(y,n)=>(c(),x("div",tt,[n[15]||(n[15]=e("div",{class:"h-1.5 rounded-t-md bg-gradient-to-r from-red-500 to-orange-500"},null,-1)),e("div",lt,[e("div",ot,[n[7]||(n[7]=e("div",{class:"flex items-center"},[e("div",{class:"mr-3 rounded-lg p-2 bg-red-100 text-red-600"},[e("i",{class:"las la-external-link-alt"})]),e("div",null,[e("div",{class:"text-sm font-medium"},"Call to Action")])],-1)),e("div",st,[e("button",{onClick:d,class:"border p-1.5 rounded-md"},[e("i",{class:B(i.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:l,class:"border p-1.5 rounded-md"},[...n[5]||(n[5]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:s,class:"rounded-md border p-1.5 text-red-600 hover:bg-red-50"},[...n[6]||(n[6]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),_.value.length?g((c(),x("div",dt,[n[8]||(n[8]=e("div",{class:"font-medium text-red-600 mb-1"}," Please fix the following issues: ",-1)),e("ul",at,[(c(!0),x(M,null,R(_.value,(o,p)=>(c(),x("li",{key:p},N(o),1))),128))])],512)),[[E,!i.value]]):O("",!0),g(e("div",null,[n[9]||(n[9]=e("label",{class:"text-xs font-medium"},"Header (Optional)",-1)),g(e("input",{"onUpdate:modelValue":n[0]||(n[0]=o=>a.value=o),class:"w-full border rounded-md p-2 text-sm mt-1",placeholder:"Enter header text (optional)"},null,512),[[V,a.value]]),e("div",nt,N(f.value)+"/"+N(Z),1)],512),[[E,!i.value]]),g(e("div",null,[n[10]||(n[10]=e("label",{class:"text-xs font-medium text-red-600"}," Value Text * ",-1)),g(e("textarea",{"onUpdate:modelValue":n[1]||(n[1]=o=>v.value=o),rows:"3",class:"w-full border rounded-md p-2 text-sm mt-1",placeholder:"Enter value text"},null,512),[[V,v.value]]),e("div",it,N(C.value)+"/"+N(J),1),v.value?O("",!0):(c(),x("div",rt," Value text is required "))],512),[[E,!i.value]]),g(e("div",null,[n[11]||(n[11]=e("label",{class:"text-xs font-medium text-red-600"}," Button Text * ",-1)),g(e("input",{"onUpdate:modelValue":n[2]||(n[2]=o=>u.value=o),class:"w-full border rounded-md p-2 text-sm mt-1",placeholder:"Click Here"},null,512),[[V,u.value]]),e("div",ut,N(r.value)+"/"+N(Q),1)],512),[[E,!i.value]]),g(e("div",null,[n[12]||(n[12]=e("label",{class:"text-xs font-medium text-red-600"}," Button Link * ",-1)),g(e("input",{"onUpdate:modelValue":n[3]||(n[3]=o=>b.value=o),class:"w-full border rounded-md p-2 text-sm mt-1",placeholder:"Enter URL (https://example.com)"},null,512),[[V,b.value]]),b.value?O("",!0):(c(),x("div",pt," Please enter a valid URL "))],512),[[E,!i.value]]),g(e("div",null,[n[13]||(n[13]=e("label",{class:"text-xs font-medium"},"Footer (Optional)",-1)),g(e("input",{"onUpdate:modelValue":n[4]||(n[4]=o=>h.value=o),class:"w-full border rounded-md p-2 text-sm mt-1",placeholder:"Enter footer text (optional)"},null,512),[[V,h.value]]),e("div",ct,N(w.value)+"/"+N(ee),1)],512),[[E,!i.value]]),g(e("div",mt,[n[14]||(n[14]=e("div",{class:"text-xs font-medium mb-2"},"Preview:",-1)),e("div",vt,N(a.value),1),e("div",bt,N(v.value||"Your value text will appear here"),1),e("button",gt,N(u.value),1),e("div",xt,N(h.value),1)],512),[[E,!i.value]])]),k(m(L),{type:"target",id:"input",position:m(S).Left,class:"!w-4 !h-4 bg-orange-500"},null,8,["position"]),k(m(L),{type:"source",id:"output",position:m(S).Right,class:"!w-4 !h-4 bg-orange-500"},null,8,["position"])]))}},yt={class:"flow-node relative rounded-xl border-2 bg-white shadow-lg overflow-hidden",style:{"min-width":"320px","max-width":"400px"}},wt={class:"p-4"},ht={class:"flex items-center justify-between mb-3"},_t={class:"flex space-x-1"},$t=["accept"],Nt={for:"media-upload",class:"cursor-pointer text-blue-600 text-sm"},Ct={key:0,class:"text-red-600 text-xs mb-2"},kt={key:1,class:"w-full bg-gray-200 h-2 rounded mb-3"},Dt={key:2,class:"mb-3"},Ut=["src"],Vt=["src"],Tt=["src"],St={key:3,class:"border rounded-md p-3 text-sm bg-gray-50"},Lt=["href"],At=2*1024*1024,Et={__name:"MediaNode",props:{id:String,data:{type:Object,required:!0}},setup(U){const t=U,a=$({get:()=>t.data.mediaUrl||"",set:n=>{t.data.updateNodeData(t.id,{mediaUrl:n})}}),v=$({get:()=>t.data.mediaType||"image",set:n=>{t.data.updateNodeData(t.id,{mediaType:n})}}),u=$({get:()=>t.data.caption||"",set:n=>{t.data.updateNodeData(t.id,{caption:n})}}),b=T(t.data.mediaUrl||""),h=T(0),f=T(!1),C=T(""),r={image:["image/jpeg","image/png","image/webp"],video:["video/mp4","video/quicktime"],audio:["audio/mpeg","audio/wav"],document:["application/pdf","application/msword"]},w=async n=>{if(C.value="",n.size>At){C.value="File must be less than 2MB";return}if(!r[v.value].includes(n.type)){C.value=`Invalid file type for ${v.value}`;return}b.value=URL.createObjectURL(n);const o=new FormData;o.append("file",n),o.append("type",v.value),f.value=!0;const D=(await ae.post("/automation/flows/upload-files",o,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:A=>{h.value=Math.round(A.loaded/A.total*100)}})).data.file_object.file;b.value=D,t.data.updateNodeData(t.id,{mediaUrl:D,mediaType:v.value}),f.value=!1},_=n=>{const o=n.target.files[0];o&&w(o)},i=n=>{n.preventDefault();const o=n.dataTransfer.files[0];o&&w(o)},d=T(!1),l=()=>d.value=!d.value,s=()=>t.data.copyNode({id:t.id}),y=()=>t.data.deleteNode(t.id);return(n,o)=>(c(),x("div",yt,[o[16]||(o[16]=e("div",{class:"h-1.5 bg-gradient-to-r from-blue-500 to-cyan-500"},null,-1)),e("div",wt,[e("div",ht,[o[7]||(o[7]=e("div",{class:"flex items-center"},[e("div",{class:"mr-3 rounded-lg p-2 bg-blue-100 text-blue-600"},[e("i",{class:"las la-photo-video"})]),e("div",{class:"text-sm font-medium"},"Media Message")],-1)),e("div",_t,[e("button",{onClick:l,class:"border p-1.5 rounded-md"},[e("i",{class:B(d.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:s,class:"border p-1.5 rounded-md"},[...o[5]||(o[5]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:y,class:"rounded-md border p-1.5 text-red-600 hover:bg-red-50"},[...o[6]||(o[6]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),g(e("div",null,[o[13]||(o[13]=e("label",{class:"text-xs font-medium"},"Media Type *",-1)),g(e("select",{"onUpdate:modelValue":o[0]||(o[0]=p=>v.value=p),class:"w-full border rounded-md p-2 text-sm mb-3"},[...o[8]||(o[8]=[e("option",{value:"image"},"Image",-1),e("option",{value:"video"},"Video",-1),e("option",{value:"audio"},"Audio",-1),e("option",{value:"document"},"Document",-1)])],512),[[P,v.value]]),e("div",{class:B(["border-2 border-dashed rounded-lg p-6 mb-3 text-center transition-all",n.isDragging?"bg-blue-100 border-blue-500":"bg-blue-50"]),onDragover:o[1]||(o[1]=(...p)=>n.onDragOver&&n.onDragOver(...p)),onDragleave:o[2]||(o[2]=(...p)=>n.onDragLeave&&n.onDragLeave(...p)),onDrop:i},[e("input",{type:"file",accept:v.value==="image"?"image/*":v.value==="video"?"video/*":v.value==="audio"?"audio/*":"*/*",onChange:_,class:"hidden",id:"media-upload"},null,40,$t),e("label",Nt,[q(" ðŸ“ Drag & Drop "+N(v.value)+" here ",1),o[9]||(o[9]=e("br",null,null,-1)),o[10]||(o[10]=e("span",{class:"text-xs text-gray-500"},"or click to upload",-1))])],34),C.value?(c(),x("div",Ct,N(C.value),1)):O("",!0),f.value?(c(),x("div",kt,[e("div",{class:"bg-blue-500 h-2 rounded",style:de({width:h.value+"%"})},null,4)])):O("",!0),o[14]||(o[14]=e("label",{class:"text-xs font-medium"},"Or Paste Media URL",-1)),g(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=p=>a.value=p),placeholder:"https://example.com/file.jpg",class:"w-full border rounded-md p-2 text-sm mb-3"},null,512),[[V,a.value]]),a.value?(c(),x("div",Dt,[v.value==="image"?(c(),x("img",{key:0,src:a.value,class:"w-full rounded-md"},null,8,Ut)):v.value==="video"?(c(),x("video",{key:1,src:a.value,controls:"",class:"w-full rounded-md"},null,8,Vt)):v.value==="audio"?(c(),x("audio",{key:2,src:a.value,controls:"",class:"w-full"},null,8,Tt)):(c(),x("div",St,[o[11]||(o[11]=q(" ðŸ“„ Document URL: ",-1)),o[12]||(o[12]=e("br",null,null,-1)),e("a",{href:a.value,target:"_blank",class:"text-blue-600 underline"}," Open Document ",8,Lt)]))])):O("",!0),o[15]||(o[15]=e("label",{class:"text-xs font-medium"},"Caption (optional)",-1)),g(e("textarea",{"onUpdate:modelValue":o[4]||(o[4]=p=>u.value=p),rows:"2",class:"w-full border rounded-md p-2 text-sm mt-1",placeholder:"Add a caption..."},null,512),[[V,u.value]])],512),[[E,!d.value]])]),k(m(L),{type:"target",id:"input",position:m(S).Left,class:"!h-4 !w-4 !border-2 !border-white bg-gradient-to-r from-blue-500 to-cyan-500"},null,8,["position"]),k(m(L),{type:"source",id:"output",position:m(S).Right,class:"!h-4 !w-4 !border-2 !border-white bg-gradient-to-r from-blue-500 to-cyan-500"},null,8,["position"])]))}},Bt={class:"flow-node relative rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"320px","max-width":"400px"}},jt={class:"p-4"},Mt={class:"flex items-center justify-between mb-3"},Rt={class:"flex space-x-1"},Ot={class:"flex justify-between items-center mb-2"},Xt=["value","onInput"],Pt=["onClick"],qt=["value","onInput"],Ft=["value","onInput"],Ht=["onClick"],zt=["onClick"],Kt={key:0,class:"mt-3 p-2 bg-red-50 text-red-700 text-xs rounded"},Wt={__name:"ListNode",props:{id:String,data:{type:Object,required:!0}},setup(U){const t=U,a=$({get:()=>t.data.title||"",set:o=>{t.data.updateNodeData(t.id,{title:o})}}),v=$({get:()=>t.data.body||"",set:o=>{t.data.updateNodeData(t.id,{body:o})}}),u=$({get:()=>t.data.footer||"",set:o=>{t.data.updateNodeData(t.id,{footer:o})}}),b=$({get:()=>t.data.buttonText||"View options",set:o=>{t.data.updateNodeData(t.id,{buttonText:o})}}),h=$(()=>t.data.sections||[]),f=()=>{t.data.updateNodeData(t.id,{sections:[...h.value,{title:"New Section",rows:[]}]})},C=o=>{const p=[...h.value];p[o].rows.forEach((A,j)=>{t.data.removeButtonEdges(t.id,`sec-${o}-row-${j}`)}),p.splice(o,1),t.data.updateNodeData(t.id,{sections:p})},r=(o,p)=>{const D=[...h.value];D[o].title=p,t.data.updateNodeData(t.id,{sections:D})},w=o=>{const p=[...h.value];p[o].rows.push({title:"",description:"",connected:!1}),t.data.updateNodeData(t.id,{sections:p})},_=(o,p)=>{const D=[...h.value];t.data.removeButtonEdges(t.id,`sec-${o}-row-${p}`),D[o].rows.splice(p,1),t.data.updateNodeData(t.id,{sections:D})},i=(o,p,D,A)=>{const j=[...h.value];j[o].rows[p][D]=A,t.data.updateNodeData(t.id,{sections:j})},d=$(()=>{const o=[];return a.value.trim()||o.push("Header is required"),v.value.trim()||o.push("Body is required"),h.value.length||o.push("At least one section is required"),h.value.forEach((p,D)=>{p.title.trim()||o.push(`Section ${D+1} title is required`),p.rows.length||o.push(`Section ${D+1} must have at least one row`),p.rows.forEach((A,j)=>{A.title.trim()||o.push(`Row ${j+1} in Section ${D+1} needs title`)})}),o}),l=T(!1),s=()=>l.value=!l.value,y=()=>t.data.copyNode({id:t.id}),n=()=>t.data.deleteNode(t.id);return(o,p)=>(c(),x("div",Bt,[p[13]||(p[13]=e("div",{class:"h-1.5 bg-green-500 rounded-t-md"},null,-1)),e("div",jt,[e("div",Mt,[p[6]||(p[6]=e("div",{class:"flex items-center"},[e("div",{class:"mr-3 rounded-lg p-2 bg-blue-100 text-blue-600"},[e("i",{class:"las la-list"})]),e("div",{class:"text-sm font-medium"},"List Message")],-1)),e("div",Rt,[e("button",{onClick:s,class:"border p-1.5 rounded-md"},[e("i",{class:B(l.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:y,class:"border p-1.5 rounded-md"},[...p[4]||(p[4]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:n,class:"border p-1.5 rounded-md text-red-600"},[...p[5]||(p[5]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),g(e("div",null,[p[8]||(p[8]=e("label",{class:"text-xs font-medium"},"Title",-1)),g(e("input",{"onUpdate:modelValue":p[0]||(p[0]=D=>a.value=D),class:"w-full border rounded-md p-2 text-sm mb-2",placeholder:"Enter list title"},null,512),[[V,a.value]]),p[9]||(p[9]=e("label",{class:"text-xs font-medium"},"Body",-1)),g(e("textarea",{"onUpdate:modelValue":p[1]||(p[1]=D=>v.value=D),rows:"3",class:"w-full border rounded-md p-2 text-sm mb-2",placeholder:"Enter message body"},null,512),[[V,v.value]]),p[10]||(p[10]=e("label",{class:"text-xs font-medium"},"Button Text",-1)),g(e("input",{"onUpdate:modelValue":p[2]||(p[2]=D=>b.value=D),class:"w-full border rounded-md p-2 text-sm mb-2"},null,512),[[V,b.value]]),p[11]||(p[11]=e("label",{class:"text-xs font-medium"},"Footer (optional)",-1)),g(e("input",{"onUpdate:modelValue":p[3]||(p[3]=D=>u.value=D),class:"w-full border rounded-md p-2 text-sm mb-3",placeholder:"Footer text"},null,512),[[V,u.value]]),p[12]||(p[12]=e("hr",{class:"my-3"},null,-1)),e("div",{class:"flex justify-between items-center mb-2"},[p[7]||(p[7]=e("span",{class:"text-sm font-medium"},"Sections",-1)),e("button",{onClick:f,class:"text-xs bg-blue-50 text-blue-600 px-2 py-1 rounded"}," + Add Section ")]),(c(!0),x(M,null,R(h.value,(D,A)=>(c(),x("div",{key:A,class:"border rounded-md p-3 mb-3 bg-blue-50"},[e("div",Ot,[e("input",{value:D.title,onInput:j=>r(A,j.target.value),class:"border rounded-md p-1 text-sm w-3/4",placeholder:"Section title"},null,40,Xt),e("button",{onClick:j=>C(A),class:"text-red-500 text-xs"}," Delete ",8,Pt)]),(c(!0),x(M,null,R(D.rows,(j,X)=>(c(),x("div",{key:X,class:"border rounded-md p-2 mb-2 bg-white relative"},[e("input",{value:j.title,onInput:H=>i(A,X,"title",H.target.value),class:"border rounded-md p-1 text-sm w-full mb-1",placeholder:"Row title"},null,40,qt),e("input",{value:j.description,onInput:H=>i(A,X,"description",H.target.value),class:"border rounded-md p-1 text-sm w-full",placeholder:"Row description (optional)"},null,40,Ft),e("button",{onClick:H=>_(A,X),class:"absolute top-1 right-2 text-red-500 text-xs"}," âœ• ",8,Ht),k(m(L),{type:"source",id:`sec-${A}-row-${X}`,position:m(S).Right,class:"!h-4 !w-4 bg-blue-500"},null,8,["id","position"])]))),128)),e("button",{onClick:j=>w(A),class:"w-full py-1 text-xs bg-blue-100 text-blue-700 rounded"}," + Add Row ",8,zt)]))),128)),d.value.length?(c(),x("div",Kt,[(c(!0),x(M,null,R(d.value,(D,A)=>(c(),x("div",{key:A},"â€¢ "+N(D),1))),128))])):O("",!0)],512),[[E,!l.value]])]),k(m(L),{type:"target",id:"input",position:m(S).Left,class:"!h-4 !w-4 bg-green-500"},null,8,["position"])]))}},Yt={class:"flow-node relative rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"320px","max-width":"400px"}},Gt={class:"p-4"},It={class:"flex items-center justify-between mb-3"},Zt={class:"flex space-x-1"},Jt={class:"grid grid-cols-2 gap-2 mb-2"},Qt=["onUpdate:modelValue"],el=["onUpdate:modelValue"],tl={class:"grid grid-cols-2 gap-2 mb-2"},ll=["onUpdate:modelValue"],ol=["onUpdate:modelValue"],sl={class:"grid grid-cols-2 gap-2 mb-2"},dl=["onUpdate:modelValue"],al=["onUpdate:modelValue"],nl=["onClick"],il={__name:"ContactNode",props:{id:String,data:Object},setup(U){var r;const t=U,a=T(((r=t.data)==null?void 0:r.contacts)||[{first_name:"",last_name:"",email:"",phone:"",company:"",title:""}]),v=()=>{a.value.push({first_name:"",last_name:"",email:"",phone:"",company:"",title:""})},u=w=>{a.value.length>1&&a.value.splice(w,1)};te(a,w=>{t.data.contacts=w},{deep:!0});const b=T(!1),h=()=>b.value=!b.value,f=()=>t.data.copyNode({id:t.id}),C=()=>t.data.deleteNode(t.id);return(w,_)=>(c(),x("div",Yt,[_[3]||(_[3]=e("div",{class:"h-1.5 bg-green-500 rounded-t-md"},null,-1)),e("div",Gt,[e("div",It,[_[2]||(_[2]=e("div",{class:"flex items-center"},[e("div",{class:"mr-3 rounded-lg p-2 bg-blue-100 text-blue-600"},[e("i",{class:"las la-id-card-alt"})]),e("div",{class:"text-sm font-medium"},"Contact Message")],-1)),e("div",Zt,[e("button",{onClick:h,class:"border p-1.5 rounded-md"},[e("i",{class:B(b.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:f,class:"border p-1.5 rounded-md"},[..._[0]||(_[0]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:C,class:"border p-1.5 rounded-md text-red-600"},[..._[1]||(_[1]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),g(e("div",null,[e("button",{onClick:v,class:"text-blue-600 text-xs font-medium"}," + Add Contact "),(c(!0),x(M,null,R(a.value,(i,d)=>(c(),x("div",{key:d,class:"border rounded-lg p-2 bg-gray-50 relative"},[e("div",Jt,[g(e("input",{"onUpdate:modelValue":l=>i.first_name=l,placeholder:"First name",class:"bw-full border rounded-md p-2 text-sm mb-2"},null,8,Qt),[[V,i.first_name]]),g(e("input",{"onUpdate:modelValue":l=>i.last_name=l,placeholder:"Last name",class:"bw-full border rounded-md p-2 text-sm mb-2"},null,8,el),[[V,i.last_name]])]),e("div",tl,[g(e("input",{"onUpdate:modelValue":l=>i.email=l,placeholder:"Email",class:"bw-full border rounded-md p-2 text-sm mb-2"},null,8,ll),[[V,i.email]]),g(e("input",{"onUpdate:modelValue":l=>i.phone=l,placeholder:"+91 9XXXXXXXXX",class:"bw-full border rounded-md p-2 text-sm mb-2"},null,8,ol),[[V,i.phone]])]),e("div",sl,[g(e("input",{"onUpdate:modelValue":l=>i.company=l,placeholder:"Company (option)",class:"bw-full border rounded-md p-2 text-sm mb-2"},null,8,dl),[[V,i.company]]),g(e("input",{"onUpdate:modelValue":l=>i.title=l,placeholder:"Title (option)",class:"bw-full border rounded-md p-2 text-sm mb-2"},null,8,al),[[V,i.title]])]),a.value.length>1?(c(),x("button",{key:0,onClick:l=>u(d),class:"text-red-500 text-xs absolute top-1 right-2"}," Remove ",8,nl)):O("",!0)]))),128))],512),[[E,!b.value]])]),k(m(L),{type:"target",position:m(S).Left,class:"!bg-green-500"},null,8,["position"]),k(m(L),{type:"source",position:m(S).Right,class:"!bg-blue-500"},null,8,["position"])]))}};const rl={class:"flow-node relative overflow-hidden rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"300px","max-width":"380px"}},ul={class:"p-4"},pl={class:"flex items-center justify-between mb-3"},cl={class:"flex space-x-1"},ml={class:"space-y-4"},vl={class:"flex gap-2 mt-1"},bl={class:"text-xs text-gray-500 italic"},gl={__name:"DelayNode",props:{id:String,data:{type:Object,default:()=>({delayValue:5,delayUnit:"minutes",updateNodeData:null,deleteNode:null,copyNode:null})}},setup(U){const t=U,a=T(!1),v=()=>{a.value=!a.value},u=$({get(){return t.data.delayValue??5},set(C){t.data.updateNodeData(t.id,{delayValue:Number(C)})}}),b=$({get(){return t.data.delayUnit??"minutes"},set(C){t.data.updateNodeData(t.id,{delayUnit:C})}}),h=()=>{t.data.copyNode({id:t.id})},f=()=>{t.data.deleteNode(t.id)};return(C,r)=>(c(),x("div",rl,[r[9]||(r[9]=e("div",{class:"h-1.5 rounded-t-md bg-gradient-to-r from-blue-500 to-indigo-500"},null,-1)),e("div",ul,[e("div",pl,[r[4]||(r[4]=F('<div class="flex items-center" data-v-a41ff01c><div class="mr-3 rounded-lg p-2 bg-blue-100 text-blue-600" data-v-a41ff01c><i class="las la-clock" data-v-a41ff01c></i></div><div data-v-a41ff01c><div class="text-sm font-medium" data-v-a41ff01c>Delay</div><span class="bg-blue-100 px-2 py-0.5 text-xs rounded-full text-blue-700" data-v-a41ff01c> Wait before next step </span></div></div>',1)),e("div",cl,[e("button",{onClick:v,class:"border p-1.5 rounded-md"},[e("i",{class:B(a.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:h,class:"border p-1.5 rounded-md"},[...r[2]||(r[2]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:f,class:"rounded-md border p-1.5 text-red-600 hover:bg-red-50"},[...r[3]||(r[3]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),g(e("div",ml,[e("div",null,[r[6]||(r[6]=e("label",{class:"text-xs font-medium"},"Delay Time *",-1)),e("div",vl,[g(e("input",{type:"number",min:"1",class:"w-1/2 border rounded-md p-2 text-sm","onUpdate:modelValue":r[0]||(r[0]=w=>u.value=w)},null,512),[[V,u.value]]),g(e("select",{"onUpdate:modelValue":r[1]||(r[1]=w=>b.value=w),class:"w-1/2 border rounded-md p-2 text-sm"},[...r[5]||(r[5]=[e("option",{value:"seconds"},"Seconds",-1),e("option",{value:"minutes"},"Minutes",-1),e("option",{value:"hours"},"Hours",-1)])],512),[[P,b.value]])])]),e("div",bl,[r[7]||(r[7]=q(" The flow will wait ",-1)),e("strong",null,N(u.value)+" "+N(b.value),1),r[8]||(r[8]=q(" before continuing. ",-1))])],512),[[E,!a.value]])]),k(m(L),{type:"target",id:"input",position:m(S).Left,class:"!bg-orange-500"},null,8,["position"]),k(m(L),{type:"source",id:"output",position:m(S).Right,class:"!bg-blue-500"},null,8,["position"])]))}},xl=Y(gl,[["__scopeId","data-v-a41ff01c"]]);const fl={class:"flow-node relative overflow-hidden rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"320px","max-width":"400px"}},yl={class:"p-4"},wl={class:"flex items-center justify-between mb-3"},hl={class:"flex space-x-1"},_l={class:"space-y-3"},$l={class:"flex gap-2"},Nl=["onUpdate:modelValue"],Cl=["onUpdate:modelValue"],kl=["onUpdate:modelValue"],Dl=["onClick"],Ul={__name:"ConditionNode",props:{id:String,data:{type:Object,default:()=>({conditions:[],updateNodeData:null,deleteNode:null,copyNode:null})}},setup(U){const t=U,a=T(!1),v=()=>{a.value=!a.value},u=$({get(){return t.data.conditions||[]},set(r){t.data.updateNodeData(t.id,{conditions:r})}}),b=()=>{u.value=[...u.value,{field:"message",operator:"contains",value:""}]},h=r=>{const w=[...u.value];w.splice(r,1),u.value=w},f=()=>{t.data.copyNode({id:t.id})},C=()=>{t.data.deleteNode(t.id)};return(r,w)=>(c(),x("div",fl,[w[5]||(w[5]=e("div",{class:"h-1.5 rounded-t-md bg-gradient-to-r from-yellow-500 to-orange-500"},null,-1)),e("div",yl,[e("div",wl,[w[2]||(w[2]=F('<div class="flex items-center" data-v-5e937ba3><div class="mr-3 rounded-lg p-2 bg-yellow-100 text-yellow-700" data-v-5e937ba3><i class="las la-code-branch" data-v-5e937ba3></i></div><div data-v-5e937ba3><div class="text-sm font-medium" data-v-5e937ba3>Condition</div><span class="text-xs bg-yellow-100 px-2 py-0.5 rounded-full" data-v-5e937ba3> If / Else logic </span></div></div>',1)),e("div",hl,[e("button",{onClick:v,class:"border p-1.5 rounded-md"},[e("i",{class:B(a.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:f,class:"border p-1.5 rounded-md"},[...w[0]||(w[0]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:C,class:"border p-1.5 rounded-md text-red-600 hover:bg-red-50"},[...w[1]||(w[1]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),g(e("div",_l,[(c(!0),x(M,null,R(u.value,(_,i)=>(c(),x("div",{key:i,class:"border rounded-md p-3 space-y-2"},[e("div",$l,[g(e("select",{"onUpdate:modelValue":d=>_.field=d,class:"w-1/3 border rounded-md p-1.5 text-sm"},[...w[3]||(w[3]=[e("option",{value:"message"},"Message",-1),e("option",{value:"contact_name"},"Contact Name",-1),e("option",{value:"phone"},"Phone",-1)])],8,Nl),[[P,_.field]]),g(e("select",{"onUpdate:modelValue":d=>_.operator=d,class:"w-1/3 border rounded-md p-1.5 text-sm"},[...w[4]||(w[4]=[e("option",{value:"contains"},"Contains",-1),e("option",{value:"equals"},"Equals",-1),e("option",{value:"starts_with"},"Starts with",-1)])],8,Cl),[[P,_.operator]]),g(e("input",{"onUpdate:modelValue":d=>_.value=d,type:"text",placeholder:"Value",class:"w-1/3 border rounded-md p-1.5 text-sm"},null,8,kl),[[V,_.value]])]),e("button",{onClick:d=>h(i),class:"text-xs text-red-500 hover:underline"}," Remove ",8,Dl)]))),128)),e("button",{onClick:b,class:"w-full border border-dashed rounded-md p-2 text-sm text-gray-600 hover:bg-gray-50"}," + Add Condition ")],512),[[E,!a.value]])]),k(m(L),{type:"source",id:"true",position:m(S).Right,class:"!h-4 !w-4 !border-2 !border-white bg-green-500 rounded-full"},null,8,["position"]),k(m(L),{type:"source",id:"false",position:m(S).Bottom,class:"!h-4 !w-4 !border-2 !border-white bg-red-500 rounded-full"},null,8,["position"]),k(m(L),{type:"target",id:"input",position:m(S).Left,class:"!h-4 !w-4 !border-2 !border-white bg-yellow-500 rounded-full"},null,8,["position"])]))}},Vl=Y(Ul,[["__scopeId","data-v-5e937ba3"]]),Tl={class:"flow-node relative overflow-hidden rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"300px","max-width":"380px"}},Sl={class:"p-4"},Ll={class:"flex items-center justify-between mb-3"},Al={class:"flex space-x-1"},El={class:"mb-3"},Bl=["id"],jl={class:"grid grid-cols-2 gap-2 mb-3"},Ml={class:"mb-3"},Rl={__name:"LocationNode",props:{id:String,data:Object},setup(U){const t=U,a=T(!1),v=()=>a.value=!a.value,u=$({get:()=>Number(t.data.latitude)||28.6139,set:l=>t.data.updateNodeData(t.id,{latitude:Number(l)})}),b=$({get:()=>Number(t.data.longitude)||77.209,set:l=>t.data.updateNodeData(t.id,{longitude:Number(l)})}),h=$({get:()=>t.data.address||"",set:l=>t.data.updateNodeData(t.id,{address:l})}),f=$(()=>({lat:u.value,lng:b.value}));te([u,b],()=>{t.data.updateNodeData(t.id,{latitude:u.value,longitude:b.value})});const C=l=>{const s=l.latLng.lat(),y=l.latLng.lng();u.value=s,b.value=y};let r=null;const w=()=>{const l=document.getElementById(`location-search-${t.id}`);!window.google||!window.google.maps||(r=new google.maps.places.Autocomplete(l,{fields:["geometry","formatted_address"]}),r.addListener("place_changed",()=>{const s=r.getPlace();if(!s.geometry)return;const y=s.geometry.location.lat(),n=s.geometry.location.lng();u.value=y,b.value=n,h.value=s.formatted_address}))};le(()=>{setTimeout(w,500)});const _=l=>{const y=$(()=>ne().props.config).value.find(n=>n.key===l);return y?y.value:""},i=()=>t.data.copyNode({id:t.id}),d=()=>t.data.deleteNode(t.id);return(l,s)=>(c(),x("div",Tl,[s[12]||(s[12]=e("div",{class:"h-1.5 rounded-t-md bg-gradient-to-r from-green-500 to-teal-500"},null,-1)),e("div",Sl,[e("div",Ll,[s[5]||(s[5]=F('<div class="flex items-center"><div class="mr-3 rounded-lg p-2 bg-green-100 text-green-600"><i class="las la-map-marker-alt text-lg"></i></div><div><div class="text-sm font-medium">Location</div><div class="text-xs text-gray-500">Send location to user</div></div></div>',1)),e("div",Al,[e("button",{onClick:v,class:"border p-1.5 rounded-md"},[e("i",{class:B(a.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:i,class:"border p-1.5 rounded-md"},[...s[3]||(s[3]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:d,class:"rounded-md border p-1.5 text-red-600 hover:bg-red-50"},[...s[4]||(s[4]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),g(e("div",null,[e("div",El,[s[6]||(s[6]=e("label",{class:"text-xs font-medium"},"Search Location",-1)),e("input",{id:`location-search-${U.id}`,type:"text",class:"w-full border rounded-md p-2 text-sm mt-1",placeholder:"Search for a location..."},null,8,Bl)]),k(m(ge),{"api-key":_("google_maps_api_key"),style:{width:"100%",height:"150px"},center:f.value,zoom:15},{default:z(()=>[k(m(be),{options:{position:f.value,draggable:!0},onDragend:C},null,8,["options"])]),_:1},8,["api-key","center"]),s[10]||(s[10]=e("hr",null,null,-1)),s[11]||(s[11]=e("hr",null,null,-1)),e("div",jl,[e("div",null,[s[7]||(s[7]=e("label",{class:"text-xs font-medium"},"Latitude",-1)),g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=y=>u.value=y),class:"w-full border p-2 rounded-md text-sm"},null,512),[[V,u.value]])]),e("div",null,[s[8]||(s[8]=e("label",{class:"text-xs font-medium"},"Longitude",-1)),g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=y=>b.value=y),class:"w-full border p-2 rounded-md text-sm"},null,512),[[V,b.value]])])]),e("div",Ml,[s[9]||(s[9]=e("label",{class:"text-xs font-medium"},"Address",-1)),g(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=y=>h.value=y),rows:"2",class:"w-full border rounded-md p-2 text-sm mt-1",placeholder:"Type or paste address..."},null,512),[[V,h.value]])])],512),[[E,!a.value]])]),k(m(L),{type:"target",position:m(S).Left,class:"!h-4 !w-4 !border-2 !border-white bg-gradient-to-r from-red-500 to-orange-500"},null,8,["position"]),k(m(L),{type:"source",position:m(S).Right,class:"!h-4 !w-4 !border-2 !border-white bg-gradient-to-r from-red-500 to-orange-500"},null,8,["position"])]))}};const Ol={class:"flow-node relative overflow-hidden rounded-lg border-2 bg-white shadow-lg",style:{"min-width":"280px","max-width":"360px"}},Xl={class:"p-4"},Pl={class:"flex items-center justify-between mb-3"},ql={class:"flex space-x-1"},Fl={__name:"EndNode",props:{id:String,data:Object},setup(U){const t=U,a=T(!1),v=()=>a.value=!a.value,u=()=>t.data.copyNode({id:t.id}),b=()=>t.data.deleteNode(t.id);return(h,f)=>(c(),x("div",Ol,[f[4]||(f[4]=e("div",{class:"h-1.5 rounded-t-md bg-gradient-to-r from-gray-700 to-black"},null,-1)),e("div",Xl,[e("div",Pl,[f[2]||(f[2]=F('<div class="flex items-center" data-v-d6cc290c><div class="mr-3 rounded-lg p-2 bg-gray-100 text-gray-700" data-v-d6cc290c><i class="las la-stop-circle text-lg" data-v-d6cc290c></i></div><div data-v-d6cc290c><div class="text-sm font-medium" data-v-d6cc290c>End Flow</div><div class="text-xs text-gray-500" data-v-d6cc290c> This stops the conversation </div></div></div>',1)),e("div",ql,[e("button",{onClick:v,class:"border p-1.5 rounded-md",title:"Collapse"},[e("i",{class:B(a.value?"las la-angle-down":"las la-angle-up")},null,2)]),e("button",{onClick:u,class:"border p-1.5 rounded-md",title:"Duplicate node"},[...f[0]||(f[0]=[e("i",{class:"las la-copy"},null,-1)])]),e("button",{onClick:b,class:"rounded-md border p-1.5 text-red-600 hover:bg-red-50",title:"Delete node"},[...f[1]||(f[1]=[e("i",{class:"las la-trash-alt"},null,-1)])])])]),g(e("div",null,[...f[3]||(f[3]=[e("div",{class:"rounded-md border border-gray-200 bg-gray-50 p-3 text-sm text-gray-700"},[e("p",{class:"font-medium mb-1"},"Flow will stop here."),e("p",{class:"text-xs"}," No further messages will be sent after this node. ")],-1)])],512),[[E,!a.value]])]),k(m(L),{type:"target",position:m(S).Left,class:"!bg-orange-500"},null,8,["position"])]))}},Hl=Y(Fl,[["__scopeId","data-v-d6cc290c"]]),zl={__name:"FlowCanvas",setup(U){const t=T([]),a=T([]),v={start:Se,text:Me,button:et,cta:ft,media:Et,list:Wt,contact:il,delay:xl,condition:Vl,location:Rl,end:Hl},f={updateNodeData:(d,l)=>{t.value=t.value.map(s=>s.id===d?{...s,data:{...s.data,...l}}:s)},deleteNode:d=>{t.value=t.value.filter(l=>l.id!==d),a.value=a.value.filter(l=>l.source!==d&&l.target!==d)},copyNode:({id:d})=>{const l=t.value.find(y=>y.id===d),s={...l,id:"node-"+Date.now(),position:{x:l.position.x+100,y:l.position.y+80},data:{...l.data,...f,isPrimary:!1}};t.value.push(s)}},C=d=>{const l=d.dataTransfer.getData("nodeType"),s={id:Date.now().toString(),type:l,position:{x:d.offsetX,y:d.offsetY}};if(l==="cta"){t.value.push({...s,data:{...f,header:"",valueText:"",buttonText:"",buttonLink:"",footer:""}});return}if(l==="button"){t.value.push({...s,data:{...f,message:"",buttons:[],removeButtonEdges:i}});return}if(l==="media"){t.value.push({...s,data:{...f,mediaType:"image",mediaUrl:"",caption:""}});return}if(l==="list"){t.value.push({...s,data:{...f,title:"",body:"",footer:"",buttonText:"View options",sections:[],removeButtonEdges:i}});return}if(l==="delay"){t.value.push({...s,data:{...f,delayValue:5,delayUnit:"minutes"}});return}if(l==="condition"){t.value.push({...s,data:{...f,conditions:[]}});return}if(l==="location"){t.value.push({...s,data:{...f,latitude:"",longitude:"",address:""}});return}if(l==="end"){t.value.push({...s,data:{...f,isPrimary:!1}});return}t.value.push({...s,data:{...f,keywords:[],isPrimary:!0}})},r=()=>{t.value=[{id:"start-"+Date.now(),type:"start",position:{x:250,y:100},data:{keywords:["hello","hi","start"],isPrimary:!0,...f}}]};le(()=>{r()});const w=d=>{a.value.push({...d,id:`edge-${d.source}-${d.target}`,animated:!0})},_=d=>{d.forEach(l=>{l.type==="remove"&&(a.value=a.value.filter(s=>s.id!==l.item.id))})},i=(d,l)=>{a.value=a.value.filter(s=>!(s.source===d&&s.sourceHandle===l))};return(d,l)=>(c(),x("div",{class:"h-full w-full border",onDrop:C,onDragover:l[2]||(l[2]=ue(()=>{},["prevent"]))},[k(m(pe),{nodes:t.value,"onUpdate:nodes":l[0]||(l[0]=s=>t.value=s),edges:a.value,"onUpdate:edges":l[1]||(l[1]=s=>a.value=s),"node-types":v,onConnect:w,onEdgesChange:_,"snap-to-grid":!0,"select-nodes-on-drag":!0,"only-render-visible-elements":!0,"snap-grid":[20,20],"min-zoom":.3,"max-zoom":2,class:"h-full"},{node:z(({node:s})=>[(c(),oe(ie(v[s.type]),re(s,{edges:a.value}),null,16,["edges"]))]),default:z(()=>[k(m(ce),{"pattern-color":"grey",gap:"16",size:"1.2"}),k(m(me)),k(m(ve),{"node-color":"#f87171","mask-color":"rgba(0,0,0,0.1)"})]),_:1},8,["nodes","edges"])],32))}},Kl={class:"h-screen flex flex-col"},Wl={class:"p-4 border-b bg-white flex justify-between items-center"},Yl={class:"font-bold text-lg"},Gl={class:"flex flex-1"},go={__name:"Builder",props:{flow:Object},setup(U){return(t,a)=>(c(),oe(se,null,{default:z(()=>[e("div",Kl,[e("div",Wl,[e("h1",Yl," Editing Flow: "+N(U.flow.name),1),a[0]||(a[0]=e("button",{class:"bg-blue-600 text-white px-4 py-2 rounded"}," Save Flow ",-1))]),e("div",Gl,[k(ye,{class:"w-1/5 border-r"}),k(zl,{class:"w-3/5 bg-gray-50"})])])]),_:1}))}};export{go as default};
